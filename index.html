<html>
<script language="Javascript" src="jquery-1.7.2.min.js">
</script>
<script language="Javascript" src="js-epub.js">
</script>
<script language="Javascript" src="js-inflate.js">
</script>
<script language="Javascript" src="js-unzip.js">
</script>
<script language="Javascript" src="base64.js">
</script>
<script>
<!--
function showPage(epub, page) {
    // The spine lists all pages in correct order
    var spine = epub.opf.spine[page];

    // The manifest contains the href of the file
    var href = epub.opf.manifest[spine]["href"];

    // All the files are stored in here, indexed by href
    var doc = epub.files[href];

    // The doc is a DOMparser created DOM. You may want to
    // work with a string version of the page contents.
    var html = new XMLSerializer().serializeToString(doc);
    $("#content")[0].contentDocument.write(html);
    $("#content")[0].contentDocument.close();
}

function processSteps(step, extras) {
  if (step == 5) {
    showPage(epub, 0);
  }
}

function init() {
jQuery.get("milne-once-a-week.epub.b64",
  function (data) {
    var rawdata = atob(data);
    epub = new JSEpub(rawdata);
    epub.processInSteps(processSteps);
  });
}
window.addEventListener("load", init, false);
page = 0;
-->
</script>
<body>
<iframe id="content" width="800px" height="600px"></iframe>
<input type="button" value="next" onclick="javascript:showPage(epub,++page);"/>
</body>
</html>
